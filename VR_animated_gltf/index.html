<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Character Interaction</title>
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-blink-controls/dist/aframe-blink-controls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@fb96ab2/dist/aframe-extras.min.js"></script><!-- Animation Controls, Nav-mesh -->
    <script src="JS/character-setup.js" ></script>
    <script src="JS/code.js" ></script>
</head>
<body>
    <div style="position:absolute; z-index: 100;">
        <div id="text" style="color:white; font-size: 1.25em; text-align:center;">Now it's ...1.4.1</div>
    </div>
    <a-scene scenemgr id="scene" background="color:#55ddff;" renderer="colorManagement:false;">
        <a-asset>
            <a-asset-item id="Western" src="assets/Western_Characters.glb" ></a-asset-item>
            <a-asset-item id="SyFy" src="assets/SciFiCity_Characters.glb" ></a-asset-item>
            <a-asset-item id="Adventure" src="assets/Adventure_Characters.glb" ></a-asset-item>
            <a-asset-item id="Base" src="assets/Base_Characters.glb" ></a-asset-item>
            <img id="Black" src="assets/textures/Characters_Black.png">
            <img id="Brown" src="assets/textures/Characters_Brown.png">
            <img id="White" src="assets/textures/Characters_White.png">
            <a-mixin id="shadowCastRec" shadow="cast:true; receive:true" ></a-mixin>
            <a-mixin id="shadowCast" shadow="cast:true; receive:false" ></a-mixin>
            <a-mixin id="shadowRec" shadow="cast:false; receive:true" ></a-mixin>
        </a-asset>

<!-- *************************************** -->
<!--        Basic VR scene for testing       -->
<!-- *************************************** -->
        <a-box id="box" 
            height="0.75" depth="0.75" width="1.5" 
            position="2.2 0.25 -2.7" rotation="0 -80 0" 
            color="#2f80d1" mixin="shadowCastRec" >
        </a-box>
        <a-cylinder id="post" height="5" radius="0.25" position="-3.5 2.5 -8" rotation="0 0 0" mixin="shadowCastRec" ></a-cylinder>

        <!-- planes don't appear to accept "clicks" from controllers for teleporting -->
        <!-- replaced floor plane with a box -->
        <a-box id="floor" nav-mesh width="10" depth="10" height="0.1" position="0 -0.05 -4.75" color="#888888" mixin="shadowRec"></a-box>

<!-- *************************************** -->
<!--    Adding GLTF Characters to Scene      -->
<!-- *************************************** -->
        <a-gltf-model id="Player1" gltf-model="#Base" 
            position="-3 0 -7" rotation="0 70 0" 
            mixin="shadowCast"  
            character-setup="modelMesh: Dummy_Male_01; modelItem: Hair_Male; modelTexture: #White;"
            animation-mixer="clip: Idle01; crossFadeDuration: 0.5">
        </a-gltf-model>
        <a-gltf-model id="Player2" gltf-model="#Base" 
            position="3 0 -3" rotation="0 -50 0" 
            mixin="shadowCast"  
            character-setup="modelMesh: Nude_Female; modelItem: Hair_Male; modelTexture: #Black;"
            animation-mixer="clip: Idle02; crossFadeDuration: 0.5"> 
        </a-gltf-model>
        
        <a-gltf-model id="Player3" gltf-model="#Base"  
            position="4 0 -8" rotation="0 -30 0"
            mixin="shadowCast" 
            character-setup="modelMesh: Nude_Male; modelItem:Hair_Female; modelTexture:#Brown"
            animation-mixer="clip: Idle01; crossFadeDuration: 0.5">
        </a-gltf-model>
<!-- 

        <a-gltf-model id="Player4" gltf-model="#Western" 
            animation-mixer="clip: Walking01; crossFadeDuration: 0.5" 
            position="-2.12495 0 -1.87901" 
            mixin="shadowCast" rotation="0 35.496454281739894 0" 
            character-setup="modelMesh: Sheriff_01; modelTexture: #Western01">
        </a-gltf-model>

        <a-gltf-model id="Player9" gltf-model="#Adventure" 
            animation-mixer="clip: Talking02; crossFadeDuration: 0.5; timeScale: 2.0; startFrame:1500;" 
            position="1 0 -1.5" 
            mixin="shadowCast" rotation="0 -30 0" 
            character-setup="modelMesh: Nude; modelItem: SwordSheath; modelTexture: #Brown">
        </a-gltf-model> 
    -->

<!-- *************************************** -->
<!--        Camera Rig & Camera              -->
<!-- *************************************** -->
        <!-- <a-entity id="cameraRig" position="0 0 0" movement-controls="speed: 0.15;"> -->
        <a-entity id="cameraRig" position="0 0 0" movement-controls="speed: 0.15; constrainToNavMesh: true;">
            <a-entity id="camera" camera="fov:80; near:0.005" position="0 1.65 0" look-controls="pointerLockEnabled:true;" ></a-entity>

            <!-- Left hand laser control -->
            <!-- console log to id controller type at line 73060 -->
            <a-entity id="leftHand"
                blink-controls="cameraRig: #cameraRig; teleportOrigin: #camera; collisionEntities: #floor; curveShootingSpeed:5;"
                hand-controls="hand: left;">
            </a-entity>

            <!-- Right hand teleport control -->
            <a-entity id="rightHand"
                blink-controls="cameraRig: #cameraRig; teleportOrigin: #camera; collisionEntities: #floor;"
                hand-controls="hand: right;">
            </a-entity>
        </a-entity>

<!-- *************************************** -->
<!--                Lighting                 -->
<!-- *************************************** -->
        <a-light type="directional" light="castShadow: true; shadowCameraVisible: false; shadowCameraLeft: -9.5" position="-3 2.5 1.5"></a-light>
        <a-light type="ambient" light="intensity:0.5;"></a-light>
        <!-- <a-light type="probe" envMap="#pisa" ></a-light> -->
   </a-scene>
</body>
</html>

<!-- below are specific settings which we'll currently ignore -->
<!-- teleport-controls="type: parabolic; collisionEntities: #ground" -->
<!-- hand-controls="hand:left; handModelStyle:toon; color:#c568ff;" -->
<!-- hand-controls="hand:right; handModelStyle:lowPoly; color:#c568ff;" laser-controls raycaster="far:3; objects: .clickable;" -->