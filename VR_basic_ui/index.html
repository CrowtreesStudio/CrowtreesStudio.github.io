<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>A-frame UI Explorations</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@fb96ab2/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-blink-controls/dist/aframe-blink-controls.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://unpkg.com/super-hands@^3.0.3/dist/super-hands.min.js"></script><!-- To grab things - uses sphere-collider from extras -->
    
    <!-- James' Components -->
    <script src="components/scene-manager.js"></script>
    <script src="components/animation-start.js"></script>
    <script src="components/character-setup.js" ></script>
    <script src="components/hand-interaction.js"></script>
    <script src="components/aframe-ui.js"></script>
    <script src="components/mesh-shadows.js"></script>

</head>
<body>
    <div style="position:absolute; z-index: 100;">
        <div id="text" style="color:white; font-size: 1.25em; text-align:center;">Now it's ...Grab 1.0.3</div>
    </div>
   <a-scene scene-manager background="color:#55bbff;">

        <a-asset>
            <a-asset-item id="Characters" src="assets/meshes/Starter_Characters.glb"></a-asset-item>
            <a-asset-item id="Scene" src="assets/meshes/SyntyStarterFreebie.glb" ></a-asset-item>
            <a-asset-item id="Navmesh" src="assets/meshes/SyntyStarterFreebie_Navmesh.glb" ></a-asset-item>
            <a-mixin id="bob" animation__pos="property:position; to:0 1.05 0; dir:alternate; loop:true; dur:1000; easing:easeInOutQuad; autoplay: false;"></a-mixin>
            <img id="frame" src="assets/ui/tooltip2.png">
            <img id="Blue" src="assets/textures/PolygonStarter_Texture_01.png">
            <img id="Red" src="assets/textures/PolygonStarter_Texture_02.png">
            <img id="Grey" src="assets/textures/PolygonStarter_Texture_03.png">
            <img id="Yellow" src="assets/textures/PolygonStarter_Texture_04.png">
            <!-- <img id="skyDome" src="assets/images/skymap.jpg"> -->
            <audio id="heartbeat" src="assets/audio/DalekHeartBeat.ogg" loop="true" volume="0.5"></audio>
        </a-asset>

        <!-- ******************************************** -->
        <!-- *       Basic VR scene for testing         * -->
        <!-- ******************************************** -->
        <!-- hover & drag-drop won't have any obvious effect -->
        <!-- without some additional event handlers or components.-->
        <!-- See the examples page for more -->
        <a-entity id="boxContainer" position="-1.347 0.675 7.087">
            <a-box 
                id="box" 
                class="grabbable clickable" 
                hand-interaction hoverable grabbable 
                position="-3 0.5 3" 
                color="#2f80d1"  
                shadow="cast:true; receive:false">
            </a-box>
        </a-entity>
        
        <a-entity id="ballContainer" position="3.4 1 6.8" scale="0.25 0.25 0.25">
            <a-sphere 
                id="smallBall"
                class="grabbable clickable" 
                mixin="bob"
                animation-start
                hand-interaction hoverable grabbable
                color="purple"  
                shadow visible="true">
            </a-sphere>
        </a-entity>

        <!-- ************************* -->
        <!-- *  Character model(s)   * -->
        <!-- ************************* -->
        <a-gltf-model id="Player1" gltf-model="#Characters" 
            position="12.686 0.379 -7.31" rotation="0 -30 0" 
            character-setup="modelMesh: Male; modelTexture: #Yellow; modelItem:Item_Hair_Male, Wep_WaterPistol_Hip"
            mesh-shadows
            animation-mixer="clip: Talking02; timeScale:2; crossFadeDuration: 0.5">
        </a-gltf-model>

        <a-gltf-model id="Player2" gltf-model="#Characters" 
            position="-13.5 0.07 5.75" rotation="0 90 0"
            mesh-shadows
            character-setup="modelMesh: Male; modelTexture: #Grey; modelItem:Wep_Sword_Hip, Wep_Shield_Back, Item_Hair_Male;"
            animation-mixer="clip: Idle01; timeScale:2; crossFadeDuration: 0.5">
        </a-gltf-model>

        <a-gltf-model id="Player3" gltf-model="#Characters" 
            position="6 0.05 15" rotation="0 -160 0"
            mesh-shadows 
            character-setup="modelMesh: Female; modelTexture: #Red; modelItem:Wep_Sword_RT, Wep_Shield_LT, Item_Hair_Female;"
            animation-mixer="clip: Idle01; timeScale:2; crossFadeDuration: 0.5">
        </a-gltf-model>

        <!-- *************************** -->
        <!-- *  Scene/Level model(s)   * -->
        <!-- *************************** -->
        <a-gltf-model id="SceneModel"
            gltf-model="#Scene"
            mesh-shadows
            position="0 0 0">
        </a-gltf-model>

        <a-gltf-model id="navmesh"
            gltf-model="#Navmesh"
            nav-mesh
            position="0 0 0"
            visible="false">
        </a-gltf-model>


        <!-- *************************** -->
        <!-- *      Scene Lights       * -->
        <!-- *************************** -->
        <a-light id="sun" 
            type="directional" 
            light="intensity: 1; castShadow: true; shadowCameraTop: 20; shadowCameraRight: 20; shadowCameraBottom: -20; shadowCameraLeft: -25; shadowMapHeight: 4048; shadowMapWidth:4048;" 
            position="2 13 9" >
        </a-light>
        <a-light id="ambient" type="ambient" light="intensity:0.5"></a-light>
        
        <!-- ***************** -->
        <!-- Cafe Int Lighting -->
        <!-- ***************** -->
        <a-light id="cafe" type="point" position="12.8 2.7 -6.6" light="color: #fff3cf; groundColor: #fff5e6; distance: 4.49"></a-light>


        <!-- ******************************************** -->
        <!-- *  Camera, Feedback Text and Controllers   * -->
        <!-- ******************************************** -->
        <a-entity id="cameraRig" position="0 0 0" movement-controls="enabled: true; speed:0.25; constrainToNavMesh: true; fly:false;">
            <!-- UI Experiments and Explorations -->
            <a-entity 
                id="aframe UI"
                visible="false" 
                aframe-ui="size:1.0 0.25; padding:0.1; uiTexture:#frame; color:#90f; opacity:1.0; debug:false;" 
                position="0.65 1.8 -1.0" 
                rotation="0 0 0"
                look-at="[camera]">
                    <a-text 
                        position="0 0 0" 
                        value="Hello there! I hope that you are well and are interested in finding out more about our town.\nIf you have any questions, please feel free to ask me. I really don't mind."
                        anchor="center"
                        height="0.25"
                        width="0.9" ></a-text>
            </a-entity>

            <a-entity 
                id="camera" 
                camera 
                position="0 1.65 0" 
                look-controls="pointerLockEnabled:true;" >
                    <!-- Cursor -->
                    <a-cursor 
                        id="cursor"
                        pointer 
                        raycaster="objects: .clickable; far: 0.5; enabled:true;"
                        position="0 0 -0.5"
                        color="#ffffff"
                        visible="false">
                    </a-cursor><!-- Cursor End -->
                    <!-- Text Field -->
                    <a-text id="feedback" value="Hello World" position="0 -0.1 -0.5" align="center" baseline="top" scale="0.15 0.15 0.15" visible="false"></a-text><!-- Text Field End -->
            </a-entity>
            
            <!-- Left hand laser control -->
            <!-- console log to id controller type at line 73060 -->
            <a-entity id="leftHand" 
                super-hands   
                hand-controls="hand: left;"
                sphere-collider="objects: .grabbable"
                laser-controls="hand:left;" raycaster="far:0.5; objects: .clickable; enabled: false;"
                blink-controls="cameraRig: #cameraRig; teleportOrigin: #camera; collisionEntities: #Navmesh;"
                >
            </a-entity>
            <!-- End of Left Hand -->

            <!-- Right hand teleport control -->
            <a-entity id="rightHand"
                super-hands
                hand-controls="hand: right;"
                sphere-collider="objects: .grabbable"
                laser-controls="hand:right;" raycaster="far:0.5; objects: .clickable; enabled: false;"
                blink-controls="cameraRig: #cameraRig; teleportOrigin: #camera; collisionEntities: #box, #tube, #floor;"
                >
            </a-entity>
            <!-- End of Right Hand -->

            </a-entity><!-- End Camera -->

            <!-- hand-tracking-controls seems to be broken now -->
            <!--<a-entity hand-tracking-controls="hand: left"></a-entity>
            <a-entity hand-tracking-controls="hand: right"></a-entity> -->

            <!-- the hand-controls does not work - appears broken:--> 
            <!-- trigger = grip, trigger+sidebutton= point+thumb up, trigger+touchpad = point + thumb down -->
        </a-entity> <!--End of cameraRig-->
       
   </a-scene>
</body>
</html>

